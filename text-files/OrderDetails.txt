<template>
    <div class="fixed inset-0 bg-black bg-opacity-50 overflow-y-auto h-full w-full flex items-center justify-center z-50" @click="$emit('close')">
      <div class="bg-white rounded-lg shadow-xl max-w-md w-full mx-4 flex flex-col" @click.stop>
        <div class="p-8 flex flex-col justify-between">
          <div class="text-center">
            <h2 class="text-3xl font-bold mb-4">Order Details</h2>
            <div class="bg-gray-100 p-4 rounded-lg mb-6">
              <p class="text-gray-700 mb-2">
                <span class="font-bold">Order #:</span> {{ order.orderNumber }}
              </p>
              <p class="text-gray-700 mb-2">
                <span class="font-bold">Status:</span> {{ order.status }}
              </p>
              <!-- Add more order details here -->
              <p class="text-gray-700 mb-2">
                <span class="font-bold">Customer:</span> {{ order.customerName }}
              </p>
              <p class="text-gray-700 mb-2">
                <span class="font-bold">Total:</span> ${{ order.total.toFixed(2) }}
              </p>
              <p class="text-gray-700">
                <span class="font-bold">Date:</span> {{ new Date(order.date).toLocaleDateString() }}
              </p>
            </div>
          </div>
  
          <div class="flex flex-col space-y-2 mt-6">
            <button @click="updateStatus"
              class="w-full py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
              Update Status
            </button>
            <button @click="manageShipment"
              class="w-full py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500">
              Manage Shipment
            </button>
            <button @click="$emit('close')"
              class="w-full py-3 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-400">
              Close
            </button>
          </div>
        </div>
      </div>
    </div>
  </template>
  
  <script>
  import { useSellerStore } from '../store/sellerStore';
  
  export default {
    name: 'OrderDetails',
    props: ['order'],
    emits: ['close'],
    setup(props, { emit }) {
      const sellerStore = useSellerStore();
  
      const updateStatus = () => {
        // Implement status update logic
        console.log('Updating status for order:', props.order._id);
        // You might want to open the UpdateOrderStatus modal here
      };
  
      const manageShipment = () => {
        // Implement shipment management logic
        console.log('Managing shipment for order:', props.order._id);
      };
  
      return {
        updateStatus,
        manageShipment
      };
    }
  };
  </script>


  =====================================Version-2====================================
  <template>
    <div class="fixed inset-0 bg-black bg-opacity-50 overflow-y-auto h-full w-full flex items-center justify-center z-50"
        @click="$emit('close')">
        <div class="bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 flex flex-col" @click.stop>
            <div class="p-8 flex flex-col justify-between">
                <div class="text-center mb-6">
                    <h2 class="text-3xl font-bold mb-4">Order Details</h2>
                    <div class="bg-gray-100 p-4 rounded-lg mb-6 flex justify-between items-center">
                        <p class="text-gray-700">
                            <span class="font-bold">Order #:</span> {{ order.orderNumber }}
                        </p>
                        <p
                            :class="`text-${getStatusColor(order.status)}-600 px-3 py-1 rounded-full text-sm font-medium`">
                            {{ order.status }}
                        </p>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <!-- Order Details Card -->
                    <div class="bg-white rounded-lg shadow p-4 border border-gray-200">
                        <h3 class="font-semibold text-gray-800 mb-3 flex items-center">
                            <svg class="w-5 h-5 mr-2 text-blue-500" fill="none" stroke="currentColor"
                                viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01">
                                </path>
                            </svg>
                            Order Details
                        </h3>
                        <p class="mb-2">Total: <span class="font-medium text-green-600">₦{{ formatCurrency(order.total)
                                }}</span></p>
                        <p class="text-sm text-gray-600">{{ numberToWords(order.total) }}</p>
                        <p class="mt-2">Date: <span class="font-medium">{{ formatDate(order.date) }}</span></p>
                        <p>Payment: <span class="font-medium">{{ order.paymentMethod }}</span></p>
                    </div>

                    <!-- Customer Card -->
                    <div class="bg-white rounded-lg shadow p-4 border border-gray-200">
                        <h3 class="font-semibold text-gray-800 mb-3 flex items-center">
                            <svg class="w-5 h-5 mr-2 text-blue-500" fill="none" stroke="currentColor"
                                viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                            </svg>
                            Customer
                        </h3>
                        <p class="font-medium mb-1">{{ order.customerName }}</p>
                        <p class="text-sm text-gray-600">{{ order.customerEmail }}</p>
                        <p class="text-sm text-gray-600">{{ order.customerPhone }}</p>
                    </div>

                    <!-- Shipping Address Card -->
                    <div class="bg-white rounded-lg shadow p-4 border border-gray-200">
                        <h3 class="font-semibold text-gray-800 mb-3 flex items-center">
                            <svg class="w-5 h-5 mr-2 text-blue-500" fill="none" stroke="currentColor"
                                viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z">
                                </path>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                            </svg>
                            Shipping Address
                        </h3>
                        <p>{{ order.address.street }}</p>
                        <p>{{ order.address.city }}, {{ order.address.state }} {{ order.address.postalCode }}</p>
                        <p>{{ order.address.country }}</p>
                    </div>

                    <!-- Products Card -->
                    <div class="bg-white rounded-lg shadow p-4 border border-gray-200">
                        <h3 class="font-semibold text-gray-800 mb-3 flex items-center">
                            <svg class="w-5 h-5 mr-2 text-blue-500" fill="none" stroke="currentColor"
                                viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"></path>
                            </svg>
                            Products
                        </h3>
                        <div v-if="order.products && order.products.length > 0" class="space-y-2">
                            <div v-for="product in order.products" :key="product.name"
                                class="flex justify-between items-center text-sm border-b border-gray-200 py-2 last:border-b-0">
                                <span>{{ product.name }} <span class="text-gray-600">(x{{ product.quantity
                                        }})</span></span>
                                <span class="font-medium">₦{{ formatCurrency(product.subtotal) }}</span>
                            </div>
                        </div>
                        <p v-else class="text-gray-500">No product information available</p>
                    </div>
                </div>

                <div class="flex flex-col space-y-2 mt-6">
                    <button @click="openUpdateStatusModal"
                        class="w-full py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        Update Status
                    </button>
                    <button @click="manageShipment"
                        class="w-full py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500">
                        Manage Shipment
                    </button>
                    <button @click="$emit('close')"
                        class="w-full py-3 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-400">
                        Close
                    </button>
                </div>
            </div>
        </div>
    </div>
</template>

<script>
import { useSellerStore } from '../store/sellerStore';

export default {
    name: 'OrderDetails',
    props: ['order'],
    emits: ['close', 'open-update-status-modal'],
    setup(props, { emit }) {
        const sellerStore = useSellerStore();

        const openUpdateStatusModal = () => {
            emit('open-update-status-modal', props.order._id);
        };

        const manageShipment = () => {
            console.log('Managing shipment for order:', props.order._id);
        };

        const formatDate = (dateString) => {
            return new Date(dateString).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
        };

        const formatCurrency = (amount) => {
            return amount.toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,');
        };

        const getStatusColor = (status) => {
            const colors = {
                'Pending': 'yellow',
                'Shipped': 'blue',
                'Delivered': 'green',
                'Cancelled': 'red'
            };
            return colors[status] || 'gray';
        };

        function numberToWords(num) {
            if (num === 0) return "Zero Naira";

            num = Math.round(num);

            const ones = ['', 'One', 'Two', 'Three', 'Four', 'Five', 'Six', 'Seven', 'Eight', 'Nine'];
            const tens = ['', '', 'Twenty', 'Thirty', 'Forty', 'Fifty', 'Sixty', 'Seventy', 'Eighty', 'Ninety'];
            const teens = ['Ten', 'Eleven', 'Twelve', 'Thirteen', 'Fourteen', 'Fifteen', 'Sixteen', 'Seventeen', 'Eighteen', 'Nineteen'];
            const scales = ['', 'Thousand', 'Million', 'Billion', 'Trillion'];

            function convertGroup(n) {
                let result = '';
                if (n >= 100) {
                    result += ones[Math.floor(n / 100)] + ' Hundred';
                    n %= 100;
                    if (n > 0) result += ' and ';
                }
                if (n >= 20) {
                    result += tens[Math.floor(n / 10)];
                    if (n % 10 > 0) result += '-' + ones[n % 10];
                } else if (n >= 10) {
                    result += teens[n - 10];
                } else if (n > 0) {
                    result += ones[n];
                }
                return result;
            }

            let result = '';
            let scaleIndex = 0;

            while (num > 0) {
                if (num % 1000 !== 0) {
                    let groupResult = convertGroup(num % 1000);
                    if (scaleIndex > 0) groupResult += ' ' + scales[scaleIndex];
                    if (result) groupResult += ', ' + result;
                    result = groupResult;
                }
                num = Math.floor(num / 1000);
                scaleIndex++;
            }

            return result + ' Naira';
        }

        return {
            openUpdateStatusModal,
            manageShipment,
            formatDate,
            formatCurrency,
            getStatusColor,
            numberToWords
        };
    }
};
</script>